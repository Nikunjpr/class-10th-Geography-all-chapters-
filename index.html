<div id="master-quiz-parts" style="width: 100%; max-width: 600px; margin: 0 auto; background: #fff; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); font-family: sans-serif; overflow: hidden; border: 1px solid #e0e0e0;">

    <!-- CSS STYLES -->
    <style>
        .hide-screen { display: none !important; }
        .full-btn { width: 100%; padding: 14px; margin: 8px 0; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; text-align: left; position: relative; transition: 0.2s; }
        .full-btn:active { transform: scale(0.98); }
        
        /* Subject Buttons */
        .b-his { background: #ffebee; color: #c62828; border-left: 6px solid #c62828; }
        .b-geo { background: #e8f5e9; color: #2e7d32; border-left: 6px solid #2e7d32; }
        .b-civ { background: #e3f2fd; color: #1565c0; border-left: 6px solid #1565c0; }
        .b-eco { background: #fff8e1; color: #f57f17; border-left: 6px solid #f57f17; }

        /* Part Buttons */
        .btn-part { background: #f5f5f5; color: #333; border: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; }
        .btn-part:hover { background: #eee; }
        .badge { background: #333; color: #fff; padding: 2px 8px; border-radius: 10px; font-size: 12px; }

        /* Quiz Options */
        .opt-btn { background: #fff; border: 2px solid #eee; color: #444; margin-bottom: 10px; }
        .correct { background: #d4edda !important; border-color: #28a745 !important; color: #155724 !important; }
        .wrong { background: #f8d7da !important; border-color: #dc3545 !important; color: #721c24 !important; }

        /* Navigation */
        .nav-box { display: flex; gap: 10px; margin-top: 15px; }
        .nav-btn { flex: 1; padding: 12px; border: none; border-radius: 5px; color: white; font-weight: bold; cursor: pointer; font-size: 14px; }
        .n-prev { background: #757575; }
        .n-next { background: #007bff; }
        .n-sub { background: #28a745; }
    </style>

    <!-- 1. HOME SCREEN (Subject Selection) -->
    <div id="screen-1" style="padding: 20px; text-align: center;">
        <h2 style="color: #d9534f; margin-top: 0;">üìö ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§¨‡•à‡§Ç‡§ï 2026</h2>
        <p style="color: #666; font-size: 14px;">‡§µ‡§ø‡§∑‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç (Select Subject):</p>
        
        <button class="full-btn b-his" onclick="openParts('history')">üìú ‡§á‡§§‡§ø‡§π‡§æ‡§∏ (History)</button>
        <button class="full-btn b-geo" onclick="openParts('geography')">üåç ‡§≠‡•Ç‡§ó‡•ã‡§≤ (Geography)</button>
        <button class="full-btn b-civ" onclick="openParts('civics')">üèõÔ∏è ‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø (Civics)</button>
        <button class="full-btn b-eco" onclick="openParts('economics')">üí∞ ‡§Ö‡§∞‡•ç‡§•‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞ (Economics)</button>
    </div>

    <!-- 2. PART SELECTION (Set 1, Set 2...) -->
    <div id="screen-2" class="hide-screen" style="padding: 20px;">
        <button onclick="goHome()" style="background:none; border:none; font-size:20px; cursor:pointer;">‚¨ÖÔ∏è Back</button>
        <h3 style="text-align: center; margin-top: 5px; color: #333;">‡§∏‡•á‡§ü ‡§ö‡•Å‡§®‡•á‡§Ç (Select Part)</h3>
        <div id="parts-list"></div>
    </div>

    <!-- 3. QUIZ SCREEN -->
    <div id="screen-3" class="hide-screen" style="padding: 15px;">
        <div style="display: flex; justify-content: space-between; font-size: 13px; color: #888; margin-bottom: 15px;">
            <span id="quiz-title" style="font-weight:bold;">Part Name</span>
            <span id="q-progress">1/20</span>
        </div>

        <div id="q-text" style="font-size: 18px; font-weight: bold; margin-bottom: 20px; line-height: 1.5;">Question?</div>
        <div id="options-box"></div>
        <div id="status-msg" style="height: 20px; text-align: center; font-weight: bold; margin-top: 10px;"></div>

        <div class="nav-box">
            <button class="nav-btn n-prev" onclick="prevQ()">‚¨ÖÔ∏è Prev</button>
            <button class="nav-btn n-sub" onclick="submitQuiz()">‚úÖ Submit</button>
            <button class="nav-btn n-next" onclick="nextQ()">Next ‚û°Ô∏è</button>
        </div>
    </div>

    <!-- 4. RESULT SCREEN -->
    <div id="screen-4" class="hide-screen" style="padding: 20px; text-align: center;">
        <h2 style="color: #2e7d32;">üéâ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ (Result)</h2>
        <div style="background: #f1f8e9; padding: 20px; border-radius: 10px; margin: 15px 0;">
            <h1 style="margin: 0; font-size: 40px; color: #333;">
                <span id="final-score">0</span> / <span id="total-qs">20</span>
            </h1>
            <p style="margin: 5px 0; color: #555;">Correct Answers</p>
        </div>
        
        <button class="full-btn" style="background: #25D366; color: white; text-align: center;" onclick="shareWA()">üì≤ WhatsApp ‡§™‡§∞ ‡§≠‡•á‡§ú‡•á‡§Ç</button>
        <button class="full-btn" style="background: #333; color: white; text-align: center;" onclick="location.reload()">üîÑ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ï‡§∞‡•á‡§Ç (Restart)</button>

        <div style="text-align: left; margin-top: 20px;">
            <h4 style="color: #d9534f; border-bottom: 2px solid #eee; padding-bottom: 5px;">‚ùå ‡§ó‡§≤‡§§ ‡§â‡§§‡•ç‡§§‡§∞‡•ã‡§Ç ‡§ï‡•Ä ‡§ú‡§æ‡§Å‡§ö:</h4>
            <div id="review-list"></div>
        </div>
    </div>

    <!-- SOUNDS -->
    <audio id="aud-cor" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>
    <audio id="aud-wro" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>

    <!-- LOGIC -->
    <script>
        // --- DATA SECTION: 20-20 QUESTIONS HERE ---
        const db = {
            history: [
                {
                    name: "Part-1 (Set 1)", 
                    qs: [
                        // ‡§Ø‡§π‡§æ‡§Å 20 ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§°‡§æ‡§≤‡•á‡§Ç
                        { q: "1. ‡§∞‡§ï‡•ç‡§§ ‡§î‡§∞ ‡§≤‡•å‡§π ‡§ï‡•Ä ‡§®‡•Ä‡§§‡§ø ‡§ï‡§ø‡§∏‡§®‡•á ‡§Ö‡§™‡§®‡§æ‡§à?", o: ["‡§Æ‡•á‡§ú‡§ø‡§®‡•Ä", "‡§π‡§ø‡§ü‡§≤‡§∞", "‡§¨‡§ø‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ï", "‡§®‡•á‡§™‡•ã‡§≤‡§ø‡§Ø‡§®"], a: 2 },
                        { q: "2. ‡§´‡•ç‡§∞‡•à‡§Ç‡§ï‡§´‡§∞‡•ç‡§ü ‡§ï‡•Ä ‡§∏‡§Ç‡§ß‡§ø ‡§ï‡§¨ ‡§π‡•Å‡§à?", o: ["1864", "1866", "1870", "1871"], a: 3 },
                        { q: "3. ‡§∞‡•Ç‡§∏ ‡§Æ‡•á‡§Ç ‡§ï‡•É‡§∑‡§ï ‡§¶‡§æ‡§∏ ‡§™‡•ç‡§∞‡§•‡§æ ‡§ï‡§æ ‡§Ö‡§Ç‡§§ ‡§ï‡§¨ ‡§π‡•Å‡§Ü?", o: ["1861", "1862", "1863", "1864"], a: 0 }
                        // ... ‡§î‡§∞ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç (‡§ï‡•â‡§™‡•Ä-‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç)
                    ]
                },
                {
                    name: "Part-2 (Set 2)", 
                    qs: [
                        { q: "1. ‡§¨‡•ã‡§≤‡§∂‡•á‡§µ‡§ø‡§ï ‡§ï‡•ç‡§∞‡§æ‡§Ç‡§§‡§ø ‡§ï‡§¨ ‡§π‡•Å‡§à?", o: ["‡§´‡§∞‡§µ‡§∞‡•Ä 1917", "‡§®‡§µ‡§Ç‡§¨‡§∞ 1917", "‡§Ö‡§™‡•ç‡§∞‡•à‡§≤ 1917", "1905"], a: 1 },
                        { q: "2. ‡§π‡§ø‡§Ç‡§¶‡§ö‡•Ä‡§® ‡§™‡§π‡•Å‡§Å‡§ö‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§™‡•ç‡§∞‡§•‡§Æ ‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞‡•Ä ‡§ï‡•å‡§® ‡§•‡•á?", o: ["‡§Ö‡§Ç‡§ó‡•ç‡§∞‡§ú", "‡§´‡•ç‡§∞‡§æ‡§Ç‡§∏‡•Ä‡§∏‡•Ä", "‡§™‡•Å‡§∞‡•ç‡§§‡§ó‡§æ‡§≤‡•Ä", "‡§°‡§ö"], a: 2 }
                        // ‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§™‡§®‡•á 20 ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§°‡§æ‡§≤‡•á‡§Ç
                    ]
                }
            ],
            geography: [
                {
                    name: "Part-1 (Set 1)",
                    qs: [
                        { q: "1. ‡§ï‡•ã‡§Ø‡§≤‡§æ ‡§ï‡§ø‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡§æ ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§® ‡§π‡•à?", o: ["‡§Ö‡§®‡§µ‡•Ä‡§ï‡§∞‡§£‡•Ä‡§Ø", "‡§®‡§µ‡•Ä‡§ï‡§∞‡§£‡•Ä‡§Ø", "‡§ú‡•à‡§µ", "‡§Ö‡§ú‡•à‡§µ"], a: 0 },
                        { q: "2. ‡§ï‡§æ‡§≤‡•Ä ‡§Æ‡•É‡§¶‡§æ ‡§ï‡§æ ‡§¶‡•Ç‡§∏‡§∞‡§æ ‡§®‡§æ‡§Æ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?", o: ["‡§¨‡§≤‡•Å‡§à", "‡§∞‡•á‡§ó‡•Å‡§∞", "‡§≤‡§æ‡§≤", "‡§™‡§∞‡•ç‡§µ‡§§‡•Ä‡§Ø"], a: 1 }
                    ]
                }
            ],
            civics: [],
            economics: []
        };

        // --- VARIABLES ---
        let currentSet = [];
        let qIdx = 0;
        let userAns = {}; // To store answers
        
        function openParts(sub) {
            let list = document.getElementById('parts-list');
            list.innerHTML = "";
            let data = db[sub];

            if(!data || data.length === 0) { alert("Questions coming soon!"); return; }

            data.forEach((part, index) => {
                let btn = document.createElement('button');
                btn.className = 'full-btn btn-part';
                btn.innerHTML = `<span>${part.name}</span> <span class="badge">${part.qs.length} Qs</span>`;
                btn.onclick = () => startTest(sub, index);
                list.appendChild(btn);
            });

            show('screen-2');
        }

        function startTest(sub, partIndex) {
            currentSet = db[sub][partIndex].qs;
            qIdx = 0;
            userAns = {};
            document.getElementById('quiz-title').innerText = db[sub][partIndex].name;
            show('screen-3');
            loadQ();
        }

        function loadQ() {
            let data = currentSet[qIdx];
            document.getElementById('q-progress').innerText = (qIdx + 1) + " / " + currentSet.length;
            document.getElementById('q-text').innerText = data.q;
            document.getElementById('status-msg').innerText = "";

            let box = document.getElementById('options-box');
            box.innerHTML = "";

            data.o.forEach((opt, i) => {
                let btn = document.createElement('button');
                btn.className = 'full-btn opt-btn';
                btn.innerText = opt;
                
                // If answered already
                if(userAns[qIdx] !== undefined) {
                    btn.disabled = true;
                    if(i === data.a) btn.classList.add('correct');
                    if(userAns[qIdx] === i && i !== data.a) btn.classList.add('wrong');
                } else {
                    btn.onclick = () => check(i, btn, data.a);
                }
                box.appendChild(btn);
            });
        }

        function check(sel, btn, cor) {
            userAns[qIdx] = sel;
            let all = document.querySelectorAll('.opt-btn');
            all.forEach(b => b.disabled = true);

            if(sel === cor) {
                btn.classList.add('correct');
                playSound('aud-cor');
                document.getElementById('status-msg').innerText = "‚úÖ ‡§∏‡§π‡•Ä!";
                document.getElementById('status-msg').style.color = "green";
            } else {
                btn.classList.add('wrong');
                all[cor].classList.add('correct');
                playSound('aud-wro');
                document.getElementById('status-msg').innerText = "‚ùå ‡§ó‡§≤‡§§!";
                document.getElementById('status-msg').style.color = "red";
            }

            // Auto Next
            setTimeout(() => {
                if(qIdx < currentSet.length - 1) nextQ();
            }, 2000);
        }

        function nextQ() {
            if(qIdx < currentSet.length - 1) {
                qIdx++;
                loadQ();
            } else {
                submitQuiz();
            }
        }

        function prevQ() {
            if(qIdx > 0) {
                qIdx--;
                loadQ();
            }
        }

        function submitQuiz() {
            let attempted = Object.keys(userAns).length;
            if(!confirm(`‡§Ü‡§™‡§®‡•á ${attempted} ‡§∏‡§µ‡§æ‡§≤ ‡§ï‡§ø‡§è ‡§π‡•à‡§Ç‡•§ Submit ‡§ï‡§∞‡•á‡§Ç?`)) return;

            let score = 0;
            let reviewHTML = "";

            currentSet.forEach((item, idx) => {
                let u = userAns[idx];
                if(u === item.a) {
                    score++;
                } else {
                    let wrongTxt = (u !== undefined) ? item.o[u] : "‡§õ‡•ã‡§°‡§º ‡§¶‡§ø‡§Ø‡§æ";
                    reviewHTML += `<div style="background:#fff3cd; padding:10px; margin-bottom:5px; border-radius:5px;">
                        <small><b>Q${idx+1}:</b> ${item.q}</small><br>
                        <span style="color:red">‚ùå ‡§Ü‡§™‡§ï‡§æ: ${wrongTxt}</span><br>
                        <span style="color:green">‚úÖ ‡§∏‡§π‡•Ä: ${item.o[item.a]}</span>
                    </div>`;
                }
            });

            document.getElementById('final-score').innerText = score;
            document.getElementById('total-qs').innerText = currentSet.length;
            document.getElementById('review-list').innerHTML = reviewHTML || "<p>‡§Ö‡§¶‡•ç‡§≠‡•Å‡§§! ‡§∏‡§¨ ‡§∏‡§π‡•Ä ‡§π‡•à‡§Ç‡•§</p>";
            show('screen-4');
        }

        function shareWA() {
            let txt = `‡§Æ‡•à‡§Ç‡§®‡•á ${document.getElementById('final-score').innerText} ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§ï‡§ø‡§Ø‡§æ! ‡§Ü‡§™ ‡§≠‡•Ä ‡§¶‡•Ä‡§ú‡§ø‡§Ø‡•á: ${window.location.href}`;
            window.open("https://wa.me/?text=" + encodeURIComponent(txt));
        }

        function show(id) {
            ['screen-1', 'screen-2', 'screen-3', 'screen-4'].forEach(s => document.getElementById(s).classList.add('hide-screen'));
            document.getElementById(id).classList.remove('hide-screen');
        }
        function goHome() { show('screen-1'); }
        function playSound(id) { document.getElementById(id).play().catch(e=>{}); }

    </script>
</div>
